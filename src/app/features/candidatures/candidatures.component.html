<div class="p-6 max-w-4xl mx-auto">

  <!-- Titre -->
  <h1 class="text-3xl font-bold mb-6 flex items-center gap-3">
    <i class="fa-solid fa-briefcase text-blue-600"></i>
    Mes Candidatures
  </h1>

  <!-- Loader -->
  <div *ngIf="loading" class="text-center text-gray-500 flex flex-col items-center gap-3 mt-10">
    <i class="fa-solid fa-spinner fa-spin text-4xl text-gray-400"></i>
    <p class="text-sm">Chargement des candidatures...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && applications.length === 0" 
       class="text-center text-gray-500 mt-16 flex flex-col items-center gap-3 animate-fadeIn">
    <i class="fa-regular fa-folder-open text-5xl text-gray-400"></i>
    <p class="text-xl font-semibold">Aucune candidature suivie</p>
    <p class="text-sm text-gray-500">
      Suivez une candidature depuis une fiche emploi pour la retrouver ici.
    </p>
  </div>

  <!-- Liste des candidatures -->
  <div class="grid gap-4" *ngIf="applications.length > 0">

    <div *ngFor="let app of applications" 
         class="border rounded-xl p-5 shadow-md bg-white hover:shadow-lg transition animate-slideUp">

      <!-- Titre -->
      <h2 class="text-lg font-bold flex items-center gap-2">
        <i class="fa-solid fa-file-lines text-blue-600"></i>
        {{ app.title }}
      </h2>

      <!-- Entreprise + localisation -->
      <p class="text-gray-600 mt-1 flex items-center gap-2">
        <i class="fa-solid fa-building text-gray-500"></i> {{ app.company }}
        <span class="text-gray-400">•</span>
        <i class="fa-solid fa-location-dot text-gray-500"></i> {{ app.location }}
      </p>

      <!-- Date -->
      <p class="text-gray-400 text-sm mt-1 flex items-center gap-2">
        <i class="fa-regular fa-calendar"></i>
        Ajoutée le : {{ app.dateAdded | date }}
      </p>

      <!-- Statut -->
      <div class="mt-4 flex items-center gap-3">

        <span class="font-medium flex items-center gap-2">
          <i class="fa-solid fa-flag"></i>
          Statut :
        </span>

        <!-- Badge dynamique -->
        <span 
          class="px-3 py-1 rounded-full text-xs font-semibold"
          [ngClass]="{
            'bg-yellow-100 text-yellow-700': app.status === 'en_attente',
            'bg-green-100 text-green-700': app.status === 'accepte',
            'bg-red-100 text-red-700': app.status === 'refuse'
          }">
          {{ app.status === 'en_attente' ? 'En attente' : app.status === 'accepte' ? 'Acceptée' : 'Refusée' }}
        </span>

        <!-- Select -->
        <select 
          class="border rounded px-3 py-1 shadow-sm focus:ring-2 focus:ring-blue-500"
          [value]="app.status"
          (change)="updateStatus(app, $event)"
        >
          <option value="en_attente">En attente</option>
          <option value="accepte">Acceptée</option>
          <option value="refuse">Refusée</option>
        </select>

      </div>

      <!-- Actions -->
      <div class="mt-5 flex justify-between items-center">

        <a 
          [href]="app.url" 
          target="_blank"
          class="text-blue-600 font-medium hover:underline flex items-center gap-2">
          <i class="fa-solid fa-arrow-up-right-from-square"></i>
          Voir l'offre
        </a>

        <button 
          (click)="remove(app.id)"
          class="text-red-600 font-medium hover:underline flex items-center gap-2">
          <i class="fa-solid fa-trash"></i>
          Supprimer
        </button>

      </div>

    </div>

  </div>

</div>
